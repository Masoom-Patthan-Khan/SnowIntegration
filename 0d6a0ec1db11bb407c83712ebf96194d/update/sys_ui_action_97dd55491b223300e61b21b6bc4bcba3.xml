<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_action">
    <sys_ui_action action="INSERT_OR_UPDATE">
        <action_name>sysverb_update</action_name>
        <active>true</active>
        <client>false</client>
        <client_script_v2><![CDATA[function onClick(g_form) {

}]]></client_script_v2>
        <comments/>
        <condition>current.canCreate()</condition>
        <form_action>true</form_action>
        <form_button>true</form_button>
        <form_button_v2>false</form_button_v2>
        <form_context_menu>false</form_context_menu>
        <form_link>false</form_link>
        <form_menu_button_v2>false</form_menu_button_v2>
        <form_style/>
        <format_for_configurable_workspace>false</format_for_configurable_workspace>
        <hint/>
        <isolate_script>false</isolate_script>
        <list_action>false</list_action>
        <list_banner_button>false</list_banner_button>
        <list_button>false</list_button>
        <list_choice>false</list_choice>
        <list_context_menu>false</list_context_menu>
        <list_link>false</list_link>
        <list_save_with_form_button>false</list_save_with_form_button>
        <list_style/>
        <messages/>
        <name>Validate and Save</name>
        <onclick/>
        <order>150</order>
        <script><![CDATA[/************************************************************
* Copyright (c) 2019-2023 VMware, Inc. All Rights Reserved.
* You may not use this product except in compliance with the License.
* This product may include a number of subcomponents with separate copyright notices and license terms. Your use of these subcomponents is subject to the terms and conditions of the subcomponent's license, as noted in the LICENSE file.
*************************************************************/

onClick();

function onClick() {
    try {
        CASLogger.debug('Inside  Save and Import.onClick:');
        var appUtil = new CASAppUtil();
        var url = gs.getUrlOnStack();
        var valid_record = false;
        var dao = new CASDaoUtil();
        var existingRecord = dao.RegisterRecordCheck(current,'update');
        var avoidParallel = new AvoidParallelScheduleJobs();
		
        if (existingRecord > 1) {
			
            gs.addErrorMessage('VMware Aria Automation endpoint has been registered with same name. ');
			action.setRedirectURL(url); 
        } else {
            var check = avoidParallel.checkQueueEmpty('Check All Topics', current.sys_id);
            if (check == true) {
                var Validate = new EndpointRegister(); // UPDATED FROM CAS TO VRA AND THEN VRA TO VMware ARIA AUTOMATION
                var ValidateToken = Validate.generateApiToken(current);
				var regionCheck = new BaseUrlCheck().HostNameRegionCheck(current);

                if (ValidateToken != false) {
                    current.api_token = ValidateToken;
                    gs.addInfoMessage("VMware Aria Automation Service updated successfully.");
					if (regionCheck != false) {
						current.u_organization_id = regionCheck;
					}
                    answer = current.update();
                    valid_record = false;
                    action.setReturnURL(url);
                    dao.checkThreadLimit();
                } else {

                    gs.addErrorMessage('Invalid credentials. Please re-enter');
                    valid_record = true;
                    action.setReturnURL(url);
                }

                if (valid_record == true) {
                    action.setRedirectURL(url);
                }
            }

            else {

                gs.addErrorMessage('Job Schedules are already running for this Endpoint. Please wait until the job Schedules are completed.');

            }
        }


    } catch (e) {
        CASLogger.error('Exception caught while saving VMware Aria Automation Endpoint : ' + e);

    }
}]]></script>
        <show_insert>false</show_insert>
        <show_multiple_update>false</show_multiple_update>
        <show_query>false</show_query>
        <show_update>true</show_update>
        <sys_class_name>sys_ui_action</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2019-07-08 06:48:36</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>97dd55491b223300e61b21b6bc4bcba3</sys_id>
        <sys_mod_count>260</sys_mod_count>
        <sys_name>Validate and Save</sys_name>
        <sys_overrides/>
        <sys_package display_value="VMware Aria Automation Plugin" source="x_vmw_cloudservice">0d6a0ec1db11bb407c83712ebf96194d</sys_package>
        <sys_policy/>
        <sys_scope display_value="VMware Aria Automation Plugin">0d6a0ec1db11bb407c83712ebf96194d</sys_scope>
        <sys_update_name>sys_ui_action_97dd55491b223300e61b21b6bc4bcba3</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-09-14 06:36:55</sys_updated_on>
        <table>x_vmw_cloudservice_register_cas_organization</table>
        <ui11_compatible>true</ui11_compatible>
        <ui16_compatible>false</ui16_compatible>
    </sys_ui_action>
</record_update>
